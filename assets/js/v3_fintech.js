const cvDataV3 = {
    profile: {
        name: "Oscar Santacruz",
        role: "Desarrollador Full Stack",
        contact: {
            phone: "CEL: 0961 853 895",
            email: "oscar.sntcrz@gmail.com"
        },
        summary: "M√°s que un desarrollador, soy un art√≠fice de la transformaci√≥n digital financiera. Con m√°s de 10 a√±os forjando soluciones cr√≠ticas, desde la migraci√≥n de cores bancarios hasta la arquitectura de microservicios de alto rendimiento. Domino el ciclo completo del dato: seguridad 3DS, integraci√≥n de pasarelas en tiempo real y automatizaci√≥n con IA. Mi c√≥digo no solo funciona; escala, asegura y revoluciona la experiencia del usuario final.",
        balance: "10+ A√ëOS EXP",
    },
    skills: [
        {
            name: "Full Stack",
            level: "Black",
            number: "0000 0000 0000 0001",
            gradient: "linear-gradient(135deg, #1a1a1a 0%, #000000 100%)", // Explicit Black
            logo: `<svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg>`
        },
        {
            name: "JavaScript",
            level: "Black",
            number: "5412 7512 3412 9856",
            gradient: "var(--card-gradient-1)",
            logo: `<svg width="30" height="30" viewBox="0 0 256 256" fill="none"><rect width="256" height="256" rx="28" fill="#F7DF1E"/><path d="M67.312 213.932l19.59-11.856c3.78 6.701 7.218 12.371 15.465 12.371 7.905 0 12.89-3.092 12.89-15.12v-81.798h24.057v82.138c0 24.917-14.606 36.259-35.916 36.259-19.245 0-30.416-9.967-36.087-21.996M152.381 211.354l19.588-11.341c5.157 8.421 11.859 14.607 23.715 14.607 9.969 0 16.325-4.984 16.325-11.858 0-8.248-6.53-11.17-17.528-15.98l-6.013-2.58c-17.357-7.387-28.87-16.667-28.87-36.257 0-18.044 13.747-31.792 35.228-31.792 15.294 0 26.292 5.328 34.196 19.247l-18.732 12.03c-4.125-7.389-8.591-10.31-15.465-10.31-7.046 0-11.514 4.468-11.514 10.31 0 7.217 4.468 10.14 14.778 14.608l6.014 2.577c20.45 8.765 31.963 17.7 31.963 37.804 0 21.654-17.012 33.51-39.867 33.51-22.339 0-36.774-10.654-43.819-24.574" fill="#000"/></svg>`
        },
        {
            name: "React",
            level: "Gold",
            number: "4000 1234 5678 9010",
            gradient: "var(--card-gradient-2)",
            logo: `<svg width="30" height="30" viewBox="0 0 256 230" fill="none"><path d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621 6.238-30.281 2.16-54.676-11.769-62.708-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848 155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233 50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165 167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266 13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923 168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586 13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488 29.348-9.723 48.443-25.443 48.443-41.52 0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345-3.24-10.257-7.612-21.163-12.963-32.432 5.106-11 9.31-21.767 12.459-31.957 2.619.758 5.16 1.557 7.61 2.4 23.69 8.156 38.14 20.213 38.14 29.504 0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787-1.524 8.219-4.59 13.698-8.382 15.893-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246 12.376-1.098 24.068-2.894 34.671-5.345.522 2.107.986 4.173 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994 7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863-6.35-5.437-9.555-10.836-9.555-15.216 0-9.322 13.897-21.212 37.076-29.293 2.813-.98 5.757-1.905 8.812-2.773 3.204 10.42 7.406 21.315 12.477 32.332-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789 8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152 7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793 2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433 4.902.192 9.899.29 14.978.29 5.218 0 10.376-.117 15.453-.343-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026 347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815 329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627 310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695 358.489 358.489 0 0 1 11.036 20.54 329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026-.344 1.668-.73 3.367-1.15 5.09-10.622-2.452-22.155-4.275-34.23-5.408-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86-22.86-10.235-22.86-22.86 10.235-22.86 22.86-22.86Z" fill="#00D8FF"/></svg>`
        },
        {
            name: "SQL / Databases",
            level: "Classic",
            number: "3782 8224 6310 0005",
            gradient: "var(--card-gradient-3)",
            logo: `<svg width="30" height="30" viewBox="0 0 24 24" fill="none"><path d="M12 2C6.48 2 2 3.79 2 6v12c0 2.21 4.48 4 10 4s10-1.79 10-4V6c0-2.21-4.48-4-10-4zm0 2c4.41 0 8 1.12 8 2s-3.59 2-8 2-8-1.12-8-2 3.59-2 8-2zM4 10.5c1.4.79 5.12 1.5 8 1.5s6.6-.71 8-1.5V12c0 .88-3.59 2-8 2s-8-1.12-8-2v-1.5zm0 5c1.4.79 5.12 1.5 8 1.5s6.6-.71 8-1.5V18c0 .88-3.59 2-8 2s-8-1.12-8-2v-2.5z" fill="#fff"/></svg>`
        },
        {
            name: ".NET Core",
            level: "Black",
            number: "6011 0009 9013 9424",
            gradient: "linear-gradient(135deg, #512BD4 0%, #8338EC 100%)",
            logo: `<svg width="30" height="30" viewBox="0 0 456 456" fill="none"><path d="M81.479 198.268c18.514 0 33.524-15.01 33.524-33.524s-15.01-33.524-33.524-33.524-33.524 15.01-33.524 33.524 15.01 33.524 33.524 33.524z" fill="#fff"/><path d="M203.614 326.216l-80.34-203.023h-53.068l112.146 267.598h43.184l112.146-267.598h-53.068l-80.34 203.023-.33.83-.33-.83zM416.911 123.193h-57.812V377.77h57.812V123.193z" fill="#fff"/></svg>`
        },
    ],
    experience: [
        {
            role: "Ingeniero Principal",
            company: "BEPSA",
            date: "2023 - 2025",
            details: "Liderazgo t√©cnico en procesadora de pagos.",
            amount: "+ LIDERAZGO",
            icon: "üöÄ",
            tasks: [
                "Seguridad en Pagos no Presente (3DS).",
                "Ciclo de Vida de tarjeta - Tokenizaci√≥n.",
                "Trabajos con proveedores VCAS - HST.",
                "ActiveMQ para servicios basados en colas.",
                "Optimizaciones de procesos de cierre.",
                "Monitorizaci√≥n de APIs.",
                "AS400 - DB2."
            ]
        },
        {
            role: "Tech Lead Contact Center",
            company: "Banco Continental",
            date: "2021 - 2023",
            details: "IVR, Bots, Integraci√≥n Core Bancario",
            amount: "+ AUTOMATIZACI√ìN",
            icon: "üìû",
            tasks: [
                "Bajar las atenciones al nivel 1 modificando core de consultas.",
                "Nivel 0 (automatizando consultas) mediante un chatbot.",
                "Creaci√≥n de un IVR con Cisco."
            ]
        },
        {
            role: "Tech Lead Tarjetas",
            company: "Banco Continental",
            date: "2018 - 2021",
            details: "Transformaci√≥n Digital - Integraciones Visa/Mastercard",
            amount: "+ IMPACTO ALTO",
            icon: "üí≥",
            tasks: [
                "Optimizaci√≥n de procesos de integraci√≥n.",
                "Integraciones a flujos de autorizaci√≥n.",
                "Integraci√≥n con procesadora Bancard/Bepsa en servicios.",
                "Integraci√≥n con procesadora Bancard/Bepsa/Cabal con archivos.",
                "Mantenimiento del core de autorizador de d√©bito (ISO 8583 PY).",
                "Debitador autom√°tico al instante con Kafka.",
                "Implementaci√≥n de ATM reciclador.",
                "Implementaci√≥n de IVA LEY en d√©bito.",
                "Procesos de asientos contables de tarjetas.",
                "Procesos de facturaci√≥n masiva para clientes."
            ]
        },
        {
            role: "Desarrollador Full Stack",
            company: "Freelance / Varios",
            date: "2014 - 2018",
            details: "Sitios web y aplicaciones a medida",
            amount: "+ DIVERSIDAD",
            icon: "üíª",
            tasks: [
                "Implementaci√≥n de m√≥dulo de pagos de salarios.",
                "Mantenimiento al core bancario.",
                "Migraci√≥n de Visual FoxPro a .NET.",
                "Mantenimiento de sistema de archivos tipo S3."
            ]
        }
    ]
};

document.addEventListener('DOMContentLoaded', () => {
    startFaceID();
    setupModal();
});

function setupModal() {
    // Close modal when clicking outside or on close button
    const overlay = document.getElementById('modal-overlay');
    const closeBtn = document.querySelector('.modal-close');

    if (overlay) {
        overlay.addEventListener('click', (e) => {
            if (e.target === overlay) closeModal();
        });
    }

    if (closeBtn) {
        closeBtn.addEventListener('click', closeModal);
    }

    // Close on Escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeModal();
    });
}

function openModal(expIndex) {
    const exp = cvDataV3.experience[expIndex];
    const overlay = document.getElementById('modal-overlay');
    const title = document.querySelector('.modal-title h2');
    const subtitle = document.querySelector('.modal-subtitle');
    const list = document.querySelector('.modal-body ul');

    title.innerText = exp.role;
    subtitle.innerText = `${exp.company} ‚Ä¢ ${exp.date}`;

    list.innerHTML = '';
    exp.tasks.forEach(task => {
        const li = document.createElement('li');
        li.innerText = task;
        list.appendChild(li);
    });

    overlay.classList.add('active');
}

function closeModal() {
    const overlay = document.getElementById('modal-overlay');
    overlay.classList.remove('active');
}

function startFaceID() {
    const statusText = document.querySelector('.status-text');
    const steps = [
        "INICIANDO ESCANEO...",
        "IDENTIFICANDO ROSTRO...",
        "VERIFICANDO BIOMETR√çA...",
        "ACCESO CONCEDIDO"
    ];

    let delay = 0;
    steps.forEach((step, index) => {
        setTimeout(() => {
            statusText.innerText = step;
            if (index === steps.length - 1) {
                unlockApp();
            }
        }, delay);
        delay += 800;
    });
}

function unlockApp() {
    const loginScreen = document.getElementById('login-screen');
    const appContainer = document.getElementById('app-container');

    loginScreen.style.opacity = '0';
    loginScreen.style.transform = 'scale(1.1)';

    setTimeout(() => {
        loginScreen.style.display = 'none';
        appContainer.style.opacity = '1';
        appContainer.style.transform = 'scale(1)';
        renderDashboard();
    }, 500);
}

function renderDashboard() {
    renderCards();
    renderTransactions();
    updateProfileInfo();
}

function updateProfileInfo() {
    const nameH3 = document.querySelector('.profile-summary h3');

    if (nameH3) {
        const profileDiv = nameH3.parentElement;

        // Clear container but keep the name
        profileDiv.innerHTML = '';
        profileDiv.appendChild(nameH3);

        const phoneP = document.createElement('p');
        phoneP.style.fontSize = '0.85rem';
        phoneP.style.color = 'var(--accent-blue)';
        phoneP.style.fontWeight = '600';
        phoneP.style.marginTop = '5px';
        phoneP.innerText = cvDataV3.profile.contact.phone;

        const emailP = document.createElement('p');
        emailP.style.fontSize = '0.8rem';
        emailP.style.opacity = '0.8';
        emailP.innerText = cvDataV3.profile.contact.email;

        profileDiv.appendChild(phoneP);
        profileDiv.appendChild(emailP);
    }

    // Inject Summary below "10+ A√ëOS"
    const headerDiv = document.querySelector('.section-header > div:first-child');
    if (headerDiv && !document.getElementById('profile-summary-text')) {
        const summaryP = document.createElement('p');
        summaryP.id = 'profile-summary-text';
        summaryP.style.marginTop = '15px';
        summaryP.style.maxWidth = '600px';
        summaryP.style.fontSize = '0.95rem';
        summaryP.style.lineHeight = '1.6';
        summaryP.style.color = '#e0e0e0';
        summaryP.innerText = cvDataV3.profile.summary;
        headerDiv.appendChild(summaryP);
    }
}

function renderCards() {
    const container = document.getElementById('cards-container');
    container.innerHTML = '';

    cvDataV3.skills.forEach(skill => {
        const card = document.createElement('div');
        card.className = 'credit-card';
        card.style.background = skill.gradient;

        // Add specific class for Black card to apply extra styles
        if (skill.level === 'Black' && skill.name === 'Full Stack') {
            card.classList.add('card-black');
        }

        card.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div class="card-chip"></div>
                ${skill.logo ? `<div style="opacity: 0.9;">${skill.logo}</div>` : ''}
            </div>
            <div class="card-number">${skill.number}</div>
            <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                <div>
                    <div class="card-holder">TECNOLOG√çA</div>
                    <div class="card-name">${skill.name}</div>
                </div>
                <div class="card-logo">${skill.level}</div>
            </div>
        `;
        container.appendChild(card);
    });
}

function renderTransactions() {
    const container = document.getElementById('transactions-container');
    container.innerHTML = '';

    cvDataV3.experience.forEach((exp, index) => {
        const item = document.createElement('div');
        item.className = 'transaction-item';
        item.innerHTML = `
            <div class="trans-icon">${exp.icon}</div>
            <div class="trans-details">
                <h3>${exp.role}</h3>
                <p>${exp.company} ‚Ä¢ ${exp.date}</p>
                <p style="font-size: 0.85rem; opacity: 0.7; margin-top: 5px;">${exp.details}</p>
            </div>
            <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 10px;">
                <div class="trans-amount">${exp.amount}</div>
                <button class="btn-detail" onclick="openModal(${index})">VER DETALLE</button>
            </div>
        `;
        container.appendChild(item);
    });
}

function switchTab(tabId) {
    document.querySelectorAll('.nav-menu button').forEach(btn => btn.classList.remove('active'));
    const btnElement = document.getElementById(`btn-${tabId}`);
    if (btnElement) {
        btnElement.classList.add('active');
    }

    if (tabId === 'dashboard') {
        document.querySelector('main').scrollTo({ top: 0, behavior: 'smooth' });
    } else if (tabId === 'cards') {
        const cardsSection = document.getElementById('cards-section');
        if (cardsSection) {
            cardsSection.scrollIntoView({ behavior: 'smooth' });
        }
    } else if (tabId === 'history') {
        const historySection = document.getElementById('history-section');
        if (historySection) {
            historySection.scrollIntoView({ behavior: 'smooth' });
        }
    }
}
